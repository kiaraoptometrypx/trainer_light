<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fan Chart with Fogging & CYL Blur (Side Buttons with Header)</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    font-family: Arial;
    font-size:15px;
    height: 100vh;
    justify-content: center;
  }

  #header {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 10px;
  }

  #container {
    display: flex;
    align-items: center;
  }

  #left-controls, #right-controls {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  #right-controls { margin-left: 20px; }
  #left-controls { margin-right: 20px; }

  #cylVal { font-weight:bold; margin-left:5px; }

  canvas {
    background: #fff;
  }

button  {
font-size:15px;
padding:2px;
height:50px;
width:100px;
border-radius:10px;
margin-top:5px;
margin-bottom:5px;
}


</style>
</head>
<body>

<!-- Header with Fog and Current CYL -->
<div id="header">
  <div>
    Current CYL: <span id="cylVal">0.00</span>
  </div>
  <div>
    All lines 
    <button id="fogBtn" onclick="toggleFogging()">Lighter</button>
  </div>
</div>

<div id="container">
  <!-- Left side buttons -->
  <div id="left-controls">
    <div>
      Line<br>
      <button onclick="changeCyl(-0.25)"> Lighter </button>
    </div>
    <div>
      Rotate<br>
      <button onclick="rotateFan(-15)"> < </button><br>
      <button onclick="rotateFan(-45)"> <<< </button>

    </div>
  </div>

  <!-- Canvas -->
  <canvas id="fan-container" width="400" height="400"></canvas>

  <!-- Right side buttons -->
  <div id="right-controls">
    <div>
      Line<br>
      <button onclick="changeCyl(0.25)"> Darker </button>
    </div>
    <div>
      Rotate<br>
      <button onclick="rotateFan(15)"> > </button><br>
      <button onclick="rotateFan(45)"> >>> </button>
    </div>

  </div>
</div>







<script>
const canvas = document.getElementById('fan-container');
const ctx = canvas.getContext('2d');

let cylBlur = 0.00;
let fogOn = true;
let fogStrength = 1.00;
let angle = 0;

const cylVal = document.getElementById('cylVal');
const fogBtn = document.getElementById('fogBtn');

// Format CYL display as "0.75 Ã— 90"
function updateCylDisplay() {
  const axis = ((90 + angle) % 180 + 180) % 180; // darkest axis
  cylVal.textContent = `${cylBlur.toFixed(2)} Ã— ${axis}`;
}

updateCylDisplay();

// Toggle fog
function toggleFogging() {
  fogOn = !fogOn;
  fogBtn.textContent = fogOn ? 'Lighter' : 'Darker';
  drawFan();
}

// Change CYL blur
function changeCyl(delta) {
  cylBlur = Math.max(0, +(cylBlur + delta).toFixed(2));
  updateCylDisplay();
  drawFan();
}

// Rotate fan
function rotateFan(delta) {
  angle = (angle + delta + 360) % 360;
  updateCylDisplay();
  drawFan();
}

// Draw fan
function drawFan() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.save();
  ctx.translate(200,200);
  ctx.rotate(angle * Math.PI / 180);

  const angles = [0,15,30,45,60,75,90,105,120,135,150,165];

  angles.forEach(a => {
    const dist = Math.min(Math.abs(a), Math.abs(a-180));
    const totalBlur = dist/15 * cylBlur + (fogOn ? fogStrength : 0);
    const layers = Math.max(1, Math.round(totalBlur * 3));

    for(let i=0; i<layers; i++){
      const offset = (i - layers/2) * 0.7;
      ctx.save();
      ctx.rotate(a * Math.PI / 180);
      ctx.lineWidth = 4;
      ctx.strokeStyle = `rgba(0,0,0,${1/layers})`;
      ctx.beginPath();
      ctx.moveTo(offset, -150);
      ctx.lineTo(offset, 150);
      ctx.stroke();
      ctx.restore();
    }
  });

  /* ðŸ”´ RED DOT â€” DARKEST AXIS (180Â°) */
  ctx.save();
  ctx.rotate(180 * Math.PI / 180);
  ctx.beginPath();
  ctx.arc(0, -170, 6, 0, Math.PI * 2);
  ctx.fillStyle = 'darkred';
  ctx.fill();
  ctx.restore();

  ctx.restore();

  // Center circle
  ctx.beginPath();
  ctx.arc(200,200,50,0,Math.PI*2);
  ctx.fillStyle = 'white';
  ctx.fill();

  // Axis labels
  ctx.fillStyle = 'black';
  ctx.font = '12px Arial';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillText('90Â°', 200, 20);
  ctx.fillText('90Â°', 200, 380);
  ctx.fillText('180Â°', 380, 200);
  ctx.fillText('0Â°', 20, 200);
}

// Initial draw
drawFan();
</script>












</body>
</html>
