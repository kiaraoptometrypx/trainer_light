<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Fan Chart with Fogging & CYL Blur (Canvas)</title>
<style>
  #fan-container {
    width: 400px;
    height: 400px;
    margin: 20px auto;
    background: #fff;
    border: 1px solid #ccc;
    display: block;
  }
  .controls { text-align:center; margin-top:10px; font-family:Arial; }
  button { font-size:16px; margin:0 5px; padding:5px 10px; }
  #cylVal { font-weight:bold; margin-left:10px; }
</style>
</head>
<body>

<div class="controls">
  CYL Blur:
  <button onclick="changeCyl(-0.25)">−</button>
  <button onclick="changeCyl(0.25)">+</button>
  <span>Current: <span id="cylVal">0.00</span></span>
</div>

<div class="controls">
  Fog:
  <button id="fogBtn" onclick="toggleFogging()">Fog 1.00 (ON)</button>
</div>

<div class="controls">
  Rotate:
  <button onclick="rotateFan(-5)">−5°</button>
  <span id="angleVal">0</span>°
  <button onclick="rotateFan(5)">+5°</button>
</div>

<canvas id="fan-container" width="400" height="400"></canvas>

<script>
const canvas = document.getElementById('fan-container');
const ctx = canvas.getContext('2d');

let cylBlur = 0.00;       // CYL blur
let fogOn = true;         // Fog toggle
let fogStrength = 1.00;
let angle = 0;

const cylVal = document.getElementById('cylVal');
const fogBtn = document.getElementById('fogBtn');
const angleVal = document.getElementById('angleVal');

// Update display
cylVal.textContent = cylBlur.toFixed(2);
angleVal.textContent = angle;

// Toggle fog
function toggleFogging() {
  fogOn = !fogOn;
  fogBtn.textContent = fogOn ? 'Fog 1.00 (ON)' : 'Fog 1.00 (OFF)';
  drawFan();
}

// Change CYL blur
function changeCyl(delta) {
  cylBlur = Math.max(0, +(cylBlur + delta).toFixed(2));
  cylVal.textContent = cylBlur.toFixed(2);
  drawFan();
}

// Rotate fan
function rotateFan(delta) {
  angle = (angle + delta + 360) % 360;
  angleVal.textContent = angle;
  drawFan();
}

// Draw fan
function drawFan() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.save();
  ctx.translate(200,200);
  ctx.rotate(angle * Math.PI / 180);

  const angles = [0,15,30,45,60,75,90,105,120,135,150,165];

  angles.forEach(a => {
    const dist = Math.min(Math.abs(a-0), Math.abs(a-180));
    const blur = dist/15 * cylBlur + (fogOn ? fogStrength : 0);

    ctx.save();
    ctx.rotate(a * Math.PI / 180);
    ctx.lineWidth = 4;
    ctx.strokeStyle = 'black';
    ctx.filter = `blur(${blur}px)`;
    ctx.beginPath();
    ctx.moveTo(0,-180);
    ctx.lineTo(0,180);
    ctx.stroke();
    ctx.restore();
  });

  ctx.restore();

  // Draw center circle
  ctx.beginPath();
  ctx.arc(200,200,50,0,Math.PI*2);
  ctx.fillStyle = 'white';
  ctx.fill();

  // Draw axis labels
  ctx.fillStyle = 'black';
  ctx.font = '12px Arial';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillText('180°', 200, 20);
  ctx.fillText('0°', 200, 380);
  ctx.fillText('90°', 380, 200);
  ctx.fillText('90°', 20, 200);
}

// Initial draw
drawFan();
</script>

</body>
</html>
